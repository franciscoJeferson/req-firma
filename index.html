<!DOCTYPE html>
<html lang="en">

<head>
  <title></title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      -moz-box-sizing: border-box;
      -webkit-box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
    }

    header {
      width: 100%;
      height: 10em;
    }
  </style>
</head>

<body>
  <div class="container p-2">
    <header class="bg-danger bg-gradient rounded d-flex align-items-center justify-content-center p-2">
      <div class="row p-3 rounded d-flex align-items-center justify-content-center text-center">
        <h5 class="text-center text-light">Cartório Moura. Oﬁcial do Registro de Imóveis da Comarca de
          Itapipoca/CE</h5>
      </div>
    </header>

    <hr />

    <p>
      Nesta área, disponibilizamos algumas minutas para requisição de abertura de firma.
    </p>
    <form class="row g-3 needs-validation" novalidate>
      <div class="col-md-12">
        <h5>Dados pessoais</h5>
      </div>
      <div class="row">
        <h6>Tipo</h6>
        <label class="form-label" for="pessoa-fisica">
          <input type="radio" name="tipo" id="pessoa-fisica" value="Pessoa física" checked>
          Pessoa física
        </label>
        <label class="form-label" for="pessoa-juridica">
          <input type="radio" name="tipo" id="pessoa-juridica" value="Pessoa jurídica">
          Pessoa jurídica
        </label>
      </div>
      <div class="col-md-12">
        <label for="nome" class="form-label">Nome <span class="text-danger">*</span></label>
        <input type="text" class="form-control" id="nome" placeholder="Jose, Ana..." required>
      </div>

      <div class="col-md-12">
        <label for="cpf" class="form-label">CPF/CNPJ <span class="text-danger">*</span></label>
        <input type="text" class="form-control" id="cpf" placeholder="000.000.000-00/000000" required>
      </div>
      <div class="row pessoa-fisica">
        <div class="col-md-6">
          <label for="rg" class="form-label">RG (Registro Geral)</label>
          <input type="text" class="form-control" id="rg">
        </div>
        <div class="col-md-6">
          <label for="rne" class="form-label">RNE (Registro Nacional de Estrangeiro)</label>
          <input type="text" class="form-control" id="rne">
        </div>
        <div class="col-md-6">
          <div class="row">
            <h6>Sexo</h6>
            <label class="form-label" for="masc">
              <input type="radio" name="sexo" id="masc" value="Masculino" checked>
              Masculino
            </label>
            <label class="form-label" for="femi">
              <input type="radio" name="sexo" id="femi" value="Feminino">
              Feminino
            </label>
          </div>
        </div>
        <div class="col-md-6">
          <label for="nacionalidade" class="form-label">Nacionalidade</label>
          <input type="text" class="form-control" id="nacionalidade">
        </div>
      </div>
      <div class="row pessoa-juridica d-none">
        <div class="col-md-6">
          <label for="ie" class="form-label">IE (Inscrição Estadual)</label>
          <input type="text" class="form-control" id="ie">
        </div>
        <div class="col-md-6">
          <label for="nire" class="form-label">NIRE (Número de Identificação do Registro de Empresas)</label>
          <input type="text" class="form-control" id="nire">
        </div>
      </div>
      <div class="col-md-12">
        <label for="fili-01" class="form-label">Filiação 01</label>
        <input type="text" class="form-control" id="fili-01" placeholder="Filiação...">
      </div>
      <div class="col-md-12">
        <label for="fili-02" class="form-label">Filiação 02</label>
        <input type="text" class="form-control" id="fili-02" placeholder="Filiação...">
      </div>
      <div class="col-md-12">
        <h5>Telefone/Contato</h5>
      </div>
      <div class="row">
        <div class="col-md-6">
          <label for="tel" class="form-label">Telefone<span class="text-danger">*</span></label>
          <input type="text" class="form-control" id="tel" placeholder="(00) 00000-0000" required>
        </div>
        <div class="col-md-6">
          <label for="email" class="form-label">Email</label>
          <input type="email" class="form-control" id="email">
        </div>
      </div>
      <div class="col-md-12">
        <h5>Endereço</h5>
      </div>
      <div class="row">
        <div class="col-md-6">
          <label for="cep" class="form-label">CEP</label>
          <div class="input-group">
            <input type="text" class="form-control" id="cep">
            <button class="btn btn-danger veri-cep" type="button">Verificar</button>
          </div>
        </div>
      </div>
      <div class="row">
        <div class="col-md-6">
          <label for="end" class="form-label">Endereço</label>
          <input type="text" class="form-control" id="end">
        </div>
        <div class="col-md-6">
          <label for="bairro" class="form-label">Bairro</label>
          <input type="text" class="form-control" id="bairro">
        </div>
      </div>
      <div class="row">
        <div class="col-md-6">
          <label class="form-label">Cidade <span class="text-danger">*</span></label>
          <select class="form-control select" name="city" id="city" required>
            <option value="" label=" "></option>
            <!-- <option value="" label=" "></option> -->
            <!-- <option value="AC">AC</option> -->
            <!-- <option value="AL">AL</option> -->
            <!-- <option value="AM">AM</option> -->
            <!-- <option value="AP">AP</option> -->
            <!-- <option value="BA">BA</option> -->
            <!-- <option value="CE">CE</option> -->
            <!-- <option value="ES">ES</option> -->
            <!-- <option value="GO">GO</option> -->
            <!-- <option value="MA">MA</option> -->
            <!-- <option value="MG">MG</option> -->
            <!-- <option value="MS">MS</option> -->
            <!-- <option value="MT">MT</option> -->
            <!-- <option value="PA">PA</option> -->
            <!-- <option value="PB">PB</option> -->
            <!-- <option value="PE">PE</option> -->
            <!-- <option value="PI">PI</option> -->
            <!-- <option value="PR">PR</option> -->
            <!-- <option value="RJ">RJ</option> -->
            <!-- <option value="RN">RN</option> -->
            <!-- <option value="RO">RO</option> -->
            <!-- <option value="RR">RR</option> -->
            <!-- <option value="RS">RS</option> -->
            <!-- <option value="SC">SC</option> -->
            <!-- <option value="SE">SE</option> -->
            <!-- <option value="SP">SP</option> -->
            <!-- <option value="TO">TO</option> -->
            <!-- <option value="Estrangeiro">Estrangeiro</option> -->
          </select>
        </div>
        <div class="col-md-6">
          <label class="form-label">Estado <span class="text-danger">*</span></label>
          <select class="form-control select" name="states" id="states" required>
            <option value="" label=" "></option>
            <!-- <option value="" label=" "></option> -->
            <!-- <option value="AC">AC</option> -->
            <!-- <option value="AL">AL</option> -->
            <!-- <option value="AM">AM</option> -->
            <!-- <option value="AP">AP</option> -->
            <!-- <option value="BA">BA</option> -->
            <!-- <option value="CE">CE</option> -->
            <!-- <option value="ES">ES</option> -->
            <!-- <option value="GO">GO</option> -->
            <!-- <option value="MA">MA</option> -->
            <!-- <option value="MG">MG</option> -->
            <!-- <option value="MS">MS</option> -->
            <!-- <option value="MT">MT</option> -->
            <!-- <option value="PA">PA</option> -->
            <!-- <option value="PB">PB</option> -->
            <!-- <option value="PE">PE</option> -->
            <!-- <option value="PI">PI</option> -->
            <!-- <option value="PR">PR</option> -->
            <!-- <option value="RJ">RJ</option> -->
            <!-- <option value="RN">RN</option> -->
            <!-- <option value="RO">RO</option> -->
            <!-- <option value="RR">RR</option> -->
            <!-- <option value="RS">RS</option> -->
            <!-- <option value="SC">SC</option> -->
            <!-- <option value="SE">SE</option> -->
            <!-- <option value="SP">SP</option> -->
            <!-- <option value="TO">TO</option> -->
            <!-- <option value="Estrangeiro">Estrangeiro</option> -->
          </select>
        </div>
      </div>
      <div class="col-md-12">
        <label for="complemento" class="form-label">Complemento</label>
        <input type="text" class="form-control" id="complemento" placeholder="Complemento...">
      </div>
      <div class="col-12 d-flex justify-content-center">
        <button class="btn btn-danger bg-gradient d-flex flex-row justify-content-center align-items-center gap-3"
          type="submit">
          <div class="spinner-border d-none" role="status">
            <span class="visually-hidden">Loading...</span>
          </div>
          Enviar requisição de firma
        </button>
      </div>
    </form>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <script>
    (() => {
      'use strict'
      let loading = false;
      const forms = document.querySelectorAll('.needs-validation')
      const veri_cep = document.querySelector('.veri-cep')

      const get_states = () => {
        axios.get('https://servicodados.ibge.gov.br/api/v1/localidades/estados?orderBy=nome').then((response) => {
          response.data.forEach((item) => {
            const option = document.createElement('option');
            option.value = item.sigla;
            option.textContent = `${item.sigla} - ${item.nome}`;
            document.querySelector('#states').append(option)
          })
        })
      }

      const get_cities = async (state) => {
        await axios.get(`https://servicodados.ibge.gov.br/api/v1/localidades/estados/${state}/municipios`).then((response) => {
          response.data.forEach((item, index) => {
            const select_element = document.querySelector('#city');
            index === 0 ? select_element.innerHtml = '' : null;
            const option = document.createElement('option');
            option.value = item.nome;
            option.textContent = item.nome;
            select_element.append(option);
          })
        })

      }

      document.querySelector('#states').addEventListener('change', (event) => {
        get_cities(event.target.value);
      })

      get_states();

      const load_content = () => {
        if (document.querySelector('#pessoa-fisica').checked) {
          document.querySelector('.pessoa-fisica').classList.remove('d-none');
          document.querySelector('.pessoa-juridica').classList.add('d-none');
          return
        }
        document.querySelector('.pessoa-fisica').classList.add('d-none');
        document.querySelector('.pessoa-juridica').classList.remove('d-none');
      }
      load_content();
      document.querySelector('#pessoa-fisica').addEventListener('change', () => {
        load_content();
      })
      document.querySelector('#pessoa-juridica').addEventListener('change', () => {
        load_content();
      })

      veri_cep.addEventListener('click', () => {
        const cep = document.querySelector('#cep').value.trim().replace(/-/gi, '')
        if (!cep || cep === "") return
        axios.get(`https://viacep.com.br/ws/${cep}/json/`).then(async (response) => {
          if (response.status !== 200) return
          if (response.data.erro) return
          
          await get_cities(response.data.uf);
          document.querySelector('#bairro').value = response.data.bairro
          document.querySelector('#states').value = response.data.uf;
          document.querySelector('#city').value = response.data.localidade
        })
      })
      const get_pessoa_tipo = () => {
        const pessoa_fisica = document.querySelector('#pessoa-fisica');
        const pessoa_juridica = document.querySelector('#pessoa-juridica');
        return pessoa_fisica.checked ? pessoa_fisica.value : pessoa_juridica.value;
      }
      const get_sexo = () => {
        const masc = document.querySelector('#masc');
        const femi = document.querySelector('#femi');
        return masc.checked ? masc.value : femi.value;
      }

      Array.from(forms).forEach(form => {
        form.addEventListener('submit', event => {
          event.preventDefault()
          if (!form.checkValidity()) {
            event.preventDefault()
            event.stopPropagation()
          } else {
            const tipo = get_pessoa_tipo();
            const nome = document.querySelector("#nome").value
            const cpf = document.querySelector("#cpf").value
            let rg = '';
            let rne = '';
            let sexo = '';
            let nacio = '';
            let ie = '';
            let nire = '';
            if (document.querySelector('#pessoa-fisica').checked) {
              rg = document.querySelector('#rg').value;
              rne = document.querySelector('#rne').value;
              sexo = get_sexo();
              nacio = document.querySelector('#nacionalidade').value;
            } else {
              ie = document.querySelector('#ie').value;
              nire = document.querySelector('#nire').value;
            }
            const fili_01 = document.querySelector("#fili-01").value
            const fili_02 = document.querySelector("#fili-02").value
            const tel = document.querySelector("#tel").value
            const email = document.querySelector("#email").value
            const cep = document.querySelector("#cep").value
            const endereco = document.querySelector("#end").value
            const bairro = document.querySelector("#bairro").value
            const cidade = document.querySelector("#city").value
            const uf = document.querySelector("#states").value
            const complemento = document.querySelector("#complemento").value

            const data = {
              Tipo: tipo,
              Nome: nome,
              CPF: cpf,
              RG: rg,
              RNE: rne,
              Nacionalidade: nacio,
              IE: ie,
              NIRE: nire,
              Filiacao_01: fili_01,
              Filiacao_02: fili_02,
              Telefone: tel,
              Email: email,
              CEP: cep,
              Endereco: endereco,
              Bairro: bairro,
              Cidade: cidade,
              UF: uf,
              Complemento: complemento,
              Created: 'x-sheetmonkey-current-date-time'
            };
            if (loading) return
            document.querySelector(".spinner-border").classList.remove("d-none")
            document.querySelector('.btn').disabled = true
            loading = true
            fetch('https://api.sheetmonkey.io/form/kkWkuo7bswDfqZibsqEALc', {
              method: 'POST',
              headers: {
                'Content-Type': 'application/json',
              },
              body: JSON.stringify(data),
            }).then((result) => {
              document.querySelector(".spinner-border").classList.add("d-none")
              document.querySelector('.btn').disabled = false
              loading = false
              if (result.status === 200) return window.open('./success.html')
              window.open('./404.html')
            }).catch((error) => {
              document.querySelector(".spinner-border").classList.add("d-none")
              document.querySelector('.btn').disabled = false
              loading = false
              window.open('./404.html')
            })
          }
          form.classList.add('was-validated')
        }, false)
      })
    })()
  </script>
</body>

</html>
